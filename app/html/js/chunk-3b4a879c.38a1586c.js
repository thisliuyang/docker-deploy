(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b4a879c"],{"21a6":function(e,t,n){(function(n){var i,a,r;(function(n,o){a=[],i=o,r="function"===typeof i?i.apply(t,a):i,void 0===r||(e.exports=r)})(0,(function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function i(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){c(i.response,t,n)},i.onerror=function(){console.error("could not download file")},i.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,n){var s=o.URL||o.webkitURL,c=document.createElement("a");t=t||e.name||"download",c.download=t,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?r(c):a(c.href)?i(e,t,n):r(c,c.target="_blank")):(c.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(c.href)}),4e4),setTimeout((function(){r(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,o){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,o),n);else if(a(e))i(e,n,o);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){r(s)}))}}:function(e,t,n,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return i(e,t,n);var r="application/octet-stream"===e.type,c=/constructor/i.test(o.HTMLElement)||o.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||r&&c||s)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},d.readAsDataURL(e)}else{var u=o.URL||o.webkitURL,p=u.createObjectURL(e);a?a.location=p:location.href=p,a=null,setTimeout((function(){u.revokeObjectURL(p)}),4e4)}});o.saveAs=c.saveAs=c,e.exports=c}))}).call(this,n("c8ba"))},bdfa:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("basic-container",[n("avue-crud",{ref:"crud",attrs:{option:e.option,"table-loading":e.loading,data:e.data,page:e.page,permission:e.permissionList,"before-open":e.beforeOpen},on:{"update:page":function(t){e.page=t},"row-update":e.rowUpdate,"row-save":e.rowSave,"row-del":e.rowDel,"search-change":e.searchChange,"search-reset":e.searchReset,"selection-change":e.selectionChange,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"menu",fn:function(t){var i=t.type,a=t.size,r=t.row;return[n("el-button",{attrs:{icon:"el-icon-view",size:a,type:i},on:{click:function(t){return e.handleView(r)}}},[e._v("查看")]),n("el-button",{attrs:{type:i,size:a,icon:"el-icon-printer"},on:{click:function(t){return e.handleDownload(r)}}},[e._v("打印")])]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)},a=[],r=(n("8e6e"),n("456d"),n("6762"),n("2fdb"),n("96cf"),n("3b8d")),o=(n("ac6a"),n("bd86")),s=n("799f"),c=n("2f62"),l=n("fcb7"),d=n("21a6"),u=n.n(d);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={data:function(){return{form:{},query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},selectionList:[],option:{height:"auto",calcHeight:30,tip:!1,searchMenuSpan:6,menuWidth:200,searchLabelWidth:100,border:!0,stripe:!0,index:!0,viewBtn:!1,editBtn:!1,delBtn:!1,excelBtn:!1,addBtn:!1,selection:!0,searchShow:!0,searchIndex:3,searchIcon:!0,dialogClickModal:!1,column:[{label:"项目名称",prop:"projectName",minWidth:160,search:!0,rules:[{required:!0,message:"请输入项目名称",trigger:"blur"}]},{label:"合同登记号",overHidden:!0,prop:"contractRegistrationNumber",minWidth:160,search:!0,rules:[]},{label:"办件编号",overHidden:!0,prop:"contractCode",minWidth:160,search:!0,rules:[]},{type:"radio",label:"申报类型",span:24,display:!0,props:{label:"dictValue",value:"dictKey"},prop:"declareType",dataType:"string",value:"1",dicUrl:"/api/blade-system/dict-biz/dictionary?code=declare_type",dicFlag:!0,border:!1,button:!1,size:"medium",disabled:!1,required:!0,rules:[{required:!0,message:"请选择申报类型"}],dicMethod:"get"},{type:"radio",label:"合同类型",span:24,display:!0,props:{label:"dictValue",value:"dictKey"},prop:"contractType",dicUrl:"/api/blade-system/dict-biz/child-list?current=1&size=10&parentId=518",required:!0,rules:[{required:!0,message:"请选择合同类型"}]},{type:"tree",label:"登记站",span:24,display:!0,overHidden:!0,minWidth:100,parent:!1,props:{label:"title",value:"value"},prop:"kiosk",dicData:[],defaultExpandedKeys:["1123598813738675201"],rules:[{required:!0,message:"请选择登记站"}]},{type:"tree",label:"登记处",span:12,overHidden:!0,minWidth:100,defaultExpandedKeys:[],parent:!1,props:{label:"title",value:"value"},dicData:[],prop:"registrationPoint",rules:[{required:!0,message:"请选择登记处"}]},{type:"tree",label:"项目计划来源",searchLabelWidth:100,minWidth:100,span:24,display:!0,parent:!1,props:{label:"dictValue",value:"dictKey"},prop:"projectPlanFrom",dicUrl:"/api/blade-system/dict-biz/child-list?current=1&size=100&parentId=520",required:!0,overHidden:!0,rules:[{required:!0,message:"请选择项目计划来源"}]},{type:"radio",label:"是否军民两用合同",searchLabelWidth:100,minWidth:120,span:24,display:!0,prop:"isClassified",dicData:[{label:"是",value:"1"},{label:"否",value:"0"}],required:!0,rules:[{required:!0,message:"请选择是否为军民两用合同"}]},{type:"radio",label:"是否申请免税",minWidth:100,span:24,display:!0,labelTip:"计划外的技术开发、技术转让、技术许可合同才可以申请免税",labelTipPlacement:"right",rules:[{required:!0,message:"请选择是否申请免税"}],prop:"isFree",hide:!0,dicData:[{label:"是",value:1},{label:"否",value:0}]},{label:"状态",prop:"contractStatus",type:"select",dataType:"string",minWidth:100,overHidden:!0,props:{label:"dictValue",value:"dictKey"},dicUrl:"/api/blade-system/dict-biz/dictionary?code=contract_status",rules:[{required:!0,message:"请输入状态",trigger:"blur"}]},{label:"提交时间",prop:"applyTime",type:"datetime",minWidth:150,searchRange:!0,searchSpan:10,valueFormat:"yyyy-MM-dd HH:mm:ss"}]},data:[]}},computed:h(h({},Object(c["b"])(["permission","userInfo"])),{},{permissionList:function(){return{addBtn:this.vaildData(this.permission.contractlist_add,!1),viewBtn:this.vaildData(this.permission.contractlist_view,!1),delBtn:this.vaildData(this.permission.contractlist_delete,!1),editBtn:this.vaildData(this.permission.contractlist_edit,!1)}},ids:function(){var e=[];return this.selectionList.forEach((function(t){e.push(t.id)})),e.join(",")}}),created:function(){this.initData()},methods:{initData:function(e){var t=this;Object(l["getDeptTree"])(e).then((function(e){var n=t.findObject(t.option.column,"kiosk"),i=e.data.data,a=i[0].children;a=a.filter((function(e){return"1364024711664652289"!==e.id&&e.hasChildren})),i[0].children=a,n.dicData=i;var r=t.findObject(t.option.column,"registrationPoint"),o=t.deepClone(i),s=o[0].children;s.forEach((function(e){return e.children=[]})),r.dicData=o}))},handleAdd:function(e){this.$router.push({path:"/contract/contract-info",query:{contractType:e}})},handleDownload:function(e){this.contractDownload(e)},contractDownload:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[t.id],e.prev=1,e.next=4,this.$http({url:"/api/api/downloadPDF/exportPdf",method:"POST",data:n,responseType:"blob"});case 4:i=e.sent,a=i.data,u()(a,t.projectName+".pdf"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),window.console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(t){return e.apply(this,arguments)}return t}(),handleListDowload:function(){var e=this;0!==this.selectionList.length?this.selectionList.forEach((function(t){e.contractDownload(t)})):this.$message.warning("请选择至少一条数据")},handleCopy:function(){if(0!==this.selectionList.length)if(1===this.selectionList.length){var e=this.selectionList[0].id;this.$router.push({path:"/contract/contract-info",query:{contractType:0,copyId:e}})}else this.$message.warning("只能选择一条条数据");else this.$message.warning("请选择至少一条数据")},handleAddClassified:function(e){this.$router.push({path:"/contract/contract-info",query:{contractType:e,isClassified:1}})},rowSave:function(e,t,n){var i=this;Object(s["add"])(e).then((function(){i.onLoad(i.page),i.$message({type:"success",message:"操作成功!"}),t()}),(function(e){n(),window.console.log(e)}))},rowUpdate:function(e){this.$router.push({path:"/contract/contract-info",query:{contractId:e.id,type:"edit"}})},handleView:function(e){this.$router.push({path:"/contract/contract-info",query:{contractId:e.id,type:"detail"}})},rowDel:function(e){var t=this;this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(s["remove"])(e.id)})).then((function(){t.onLoad(t.page),t.$message({type:"success",message:"操作成功!"})}))},handleDelete:function(){var e=this;0!==this.selectionList.length?this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(s["remove"])(e.ids)})).then((function(){e.onLoad(e.page),e.$message({type:"success",message:"操作成功!"}),e.$refs.crud.toggleSelection()})):this.$message.warning("请选择至少一条数据")},beforeOpen:function(e,t){var n=this;["edit","view"].includes(t)&&Object(s["getDetail"])(this.form.id).then((function(e){n.form=e.data.data})),e()},searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},selectionChange:function(e){this.selectionList=e},selectionClear:function(){this.selectionList=[],this.$refs.crud.toggleSelection()},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.loading=!0,this.query.projectName||this.query.contractRegistrationNumber||this.query.contractCode){var i=h(h(h({},n),this.query),{},{contractStatusList:[10,14],isFree:1}),a=i.applyTime,r=i.createTime;a&&(i.startApplyTime=a[0],i.endApplyTime=a[1],i.applyTime=null),r&&(i.startTime=r[0],i.endTime=r[1],i.createTime=null),i.contractStatusList=[10,14],delete i.contractStatus,Object.keys(i).forEach((function(e){(t.validatenull(i[e])||e.includes("$"))&&delete i[e]})),Object(s["getListPage"])(e.currentPage,e.pageSize,i).then((function(e){var n=e.data.data;t.page.total=n.total,t.data=n.records,t.loading=!1,t.selectionClear()}))}else this.loading=!1}}},g=f,m=n("2877"),b=Object(m["a"])(g,i,a,!1,null,null,null);t["default"]=b.exports}}]);