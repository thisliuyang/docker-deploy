(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5438fe5b"],{"0d4d":function(e,t,n){},"42b2":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("basic-container",[n("avue-crud",{ref:"crud",attrs:{option:e.option,"table-loading":e.loading,data:e.data},on:{"search-change":e.searchChange,"search-reset":e.searchReset,"selection-change":e.selectionChange,"current-change":e.currentChange,"size-change":e.sizeChange,"refresh-change":e.refreshChange,"on-load":e.onLoad},scopedSlots:e._u([{key:"menu",fn:function(t){return[n("el-button",{staticClass:"none-border",attrs:{type:"text",size:"small",plain:""},on:{click:function(n){return n.stopPropagation(),e.handleWork(t.row)}}},[e._v("审核\n      ")])]}},{key:"processDefinitionVersion",fn:function(t){var o=t.row;return[n("el-tag",[e._v("v"+e._s(o.processDefinitionVersion))])]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[n("template",{slot:"menuLeft"},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-check",plain:""},on:{click:e.handleCheck}},[e._v("批量审核\n      ")])],1)],2),n("el-dialog",{attrs:{title:"流程图","append-to-body":"",visible:e.flowBox,fullscreen:!0},on:{"update:visible":function(t){e.flowBox=t}}},[n("iframe",{attrs:{src:e.flowUrl,width:"100%",height:"700",title:"流程图",frameBorder:"no",border:"0",marginWidth:"0",marginHeight:"0",scrolling:"no",allowTransparency:"yes"}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.flowBox=!1}}},[e._v("关 闭")])],1)]),n("el-dialog",{staticClass:"contract-info-dialog",attrs:{title:"批量审核","append-to-body":"",visible:e.checkIsShow},on:{"update:visible":function(t){e.checkIsShow=t}}},[e.checkIsShow?n("avue-form",{ref:"checkForm",attrs:{option:e.checkOption},model:{value:e.checkForm,callback:function(t){e.checkForm=t},expression:"checkForm"}}):e._e(),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.checkIsShow=!1}}},[e._v("关 闭")]),n("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleCheckSubmit}},[e._v("确 定")])],1)],1)],1)},a=[],r=(n("8e6e"),n("456d"),n("6b54"),n("87b3"),n("96cf"),n("3b8d")),c=(n("ac6a"),n("bd86")),i=n("2f62"),s=n("1e69"),l=n("7208"),u=n("375c");function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(c["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p={data:function(){return{form:{},selectionId:"",selectionList:[],query:{},loading:!0,page:{pageSize:10,currentPage:1,total:0},flowBox:!1,flowUrl:"",workBox:!1,option:{height:"auto",calcHeight:30,tip:!1,simplePage:!0,searchShow:!0,searchMenuSpan:6,border:!0,stripe:!0,index:!0,selection:!0,editBtn:!1,addBtn:!1,viewBtn:!1,delBtn:!1,dialogWidth:900,menuWidth:150,dialogClickModal:!1,column:[{label:"当前步骤",prop:"taskName"},{label:"申请类型",prop:"isTrue",dicData:[{label:"离开单位",value:"1"},{label:"加入单位",value:"0"}]},{label:"姓名",prop:"realName",bind:"user.realName",overHidden:!0,minWidth:100},{label:"身份证",prop:"card",bind:"user.card",overHidden:!0,minWidth:100},{label:"电话",prop:"phone",bind:"user.phone",overHidden:!0,minWidth:100}]},data:[],checkIsShow:!1,checkForm:{},checkOption:{disabled:!1,labelPosition:"right",labelSuffix:"：",labelWidth:100,gutter:0,menuBtn:!0,submitBtn:!1,emptyBtn:!1,emptyText:"清空",menuPosition:"center",column:[{type:"radio",label:"审批结果",dicData:[{label:"受理",value:"ok"},{label:"返回修改",value:"fail"},{label:"不予受理",value:"invalid"}],span:24,cascaderItem:[],display:!0,prop:"result",rules:[{required:!0,message:"请选择审批结果"}]},{type:"select",label:"审批意见",dicUrl:"/api/blade-system/dict-biz/dictionary?code=reason",props:{label:"dictValue",value:"dictKey"},span:24,cascaderItem:[],display:!0,prop:"reason",rules:[{required:!1,message:"请选择审批意见"}]},{type:"textarea",label:"备注",span:24,display:!0,prop:"comment"}]}}},computed:h(h({},Object(i["b"])(["permission","flowRoutes"])),{},{ids:function(){var e=[];return this.selectionList.forEach((function(t){e.push(t.id)})),e.join(",")}}),methods:{searchReset:function(){this.query={},this.onLoad(this.page)},searchChange:function(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},selectionChange:function(e){this.selectionList=e},selectionClear:function(){this.selectionList=[],this.$refs.crud.toggleSelection()},handleWork:function(e){this.$router.push({path:"/work/process/".concat(Object(l["b"])(this.flowRoutes,e.category),"/handle/").concat(e.taskId,"/").concat(e.processInstanceId,"/").concat(e.businessId),query:{card:e.user.card,phone:e.user.phone}})},handleCheck:function(){if(0===this.selectionList.length)return this.$message.warning("请选择至少一条数据");this.checkIsShow=!0},handleCheckSubmit:function(){var e=this;this.$refs.checkForm.validate(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,o){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=27;break}e.loading=!0,t.prev=2,a=e.selectionList.map((function(t){return{taskId:t.taskId,processInstanceId:t.processInstanceId,flag:e.checkForm.result,comment:e.checkForm.comment+"###$$$"+e.checkForm.reason,contractId:t.contractId}})),r=0;case 5:if(!(r<a.length)){t.next=11;break}return t.next=8,Object(u["completeTask"])(a[r]);case 8:r++,t.next=5;break;case 11:e.selectionClear(),e.checkIsShow=!1,e.$message.success("审批成功"),e.onLoad(e.page),e.checkForm={},t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](2),e.message.error(t.t0.toString());case 21:return t.prev=21,e.loading=!1,o(),t.finish(21);case 25:t.next=28;break;case 27:e.$message.warning("请先填写批复意见");case 28:case"end":return t.stop()}}),t,null,[[2,18,21,25]])})));return function(e,n){return t.apply(this,arguments)}}())},handleDetail:function(e){this.$router.push({path:"/work/process/".concat(Object(l["b"])(this.flowRoutes,e.category),"/detail/").concat(e.processInstanceId,"/").concat(e.businessId)})},handleContractDetail:function(e){console.log("row :>> ",e),this.$router.push({path:"/contract/contract-info",query:{contractId:e.contractId,type:"edit"}})},handleImage:function(e){this.flowUrl="/api/blade-flow/process/diagram-view?processInstanceId=".concat(e.processInstanceId),this.flowBox=!0},currentChange:function(e){this.page.currentPage=e},sizeChange:function(e){this.page.pageSize=e},refreshChange:function(){this.onLoad(this.page,this.query)},onLoad:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=h(h({},this.query),{},{category:"flow_4"});this.loading=!0,Object(s["todoList"])(e.currentPage,e.pageSize,Object.assign(n,o)).then((function(e){var n=e.data.data;t.page.total=n.total,t.data=n.records,t.loading=!1,t.selectionClear()}))}}},f=p,g=(n("eaac"),n("2877")),b=Object(g["a"])(f,o,a,!1,null,null,null);t["default"]=b.exports},7208:function(e,t,n){"use strict";function o(e){return"flow_".concat(e)}function a(e,t){var n=e.filter((function(e){return e.routeKey===t}));return 0===n.length?[]:n[0].routeValue}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}))},eaac:function(e,t,n){"use strict";n("0d4d")}}]);